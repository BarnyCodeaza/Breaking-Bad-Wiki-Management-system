<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Detalii Personaj</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background-color: #1a1a1a; color: #fff; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }

    .container {
      background: #2c2c2c;
      width: 800px;
      display: flex;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      border: 1px solid #333;
    }

    .image-section { width: 40%; background: #000; }
    .image-section img { width: 100%; height: 100%; object-fit: cover; display: block; }

    .info-section { width: 60%; padding: 40px; text-align: left; }

    h1 { color: #369457; margin-top: 0; font-size: 2.5em; margin-bottom: 5px; }
    .nickname { color: #888; font-style: italic; font-size: 1.2em; margin-bottom: 20px; display: block; border-bottom: 1px solid #444; padding-bottom: 20px; }

    .detail-row { margin-bottom: 15px; font-size: 1.1em; }
    .label { color: #369457; font-weight: bold; margin-right: 10px; }

    .btn-back {
      display: inline-block;
      margin-top: 30px;
      padding: 10px 25px;
      background-color: #444;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      transition: 0.3s;
    }
    .btn-back:hover { background-color: #666; }

    /* Stil pentru liste (ocupatii) */
    ul { margin: 5px 0; padding-left: 20px; }
    li { margin-bottom: 5px; color: #ddd; }
  </style>
</head>
<body>

<div class="container" id="cardContainer">
  <p style="padding: 20px;">Se încarcă detaliile...</p>
</div>

<script>
  async function incarcaDetalii() {
    // 1. Citim ID-ul din URL (ex: details.html?id=50)
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    // Dacă nu avem ID în URL, afișăm eroare
    if (!id) {
      document.getElementById('cardContainer').innerHTML = "<p style='padding:20px'>ID lipsă. Mergi înapoi la listă.</p>";
      return;
    }

    try {
      // 2. Cerem datele de la Backend pentru UN SINGUR personaj
      // Observă endpoint-ul: /api/data?id=... (NU /api/data/all)
      const response = await fetch(`http://localhost:8080/api/data?id=${id}`);

      if (!response.ok) throw new Error("Nu am găsit personajul");

      const entity = await response.json();
      const info = entity.data;

      // Verificăm dacă occupation e listă sau text, ca să nu crape
      let occupationList = "";
      if (Array.isArray(info.occupation)) {
        occupationList = info.occupation.map(job => `<li>${job}</li>`).join('');
      } else {
        occupationList = `<li>${info.occupation || 'Necunoscut'}</li>`;
      }

      // 3. Afișăm datele în HTML
      document.getElementById('cardContainer').innerHTML = `
                    <div class="image-section">
                        <img src="${info.image || 'https://via.placeholder.com/400'}" alt="${info.name}">
                    </div>
                    <div class="info-section">
                        <h1>${info.name}</h1>
                        <span class="nickname">"${info.nickname}"</span>

                        <div class="detail-row"><span class="label">Actor:</span> ${info.portrayed}</div>
                        <div class="detail-row"><span class="label">Status:</span> ${info.status}</div>
                        <div class="detail-row"><span class="label">Zi de naștere:</span> ${info.birthday}</div>

                        <div class="detail-row">
                            <span class="label">Ocupații:</span>
                            <ul>
                                ${occupationList}
                            </ul>
                        </div>

                        <a href="index.html" class="btn-back">⬅ Înapoi la listă</a>
                    </div>
                `;

    } catch (error) {
      console.error(error);
      document.getElementById('cardContainer').innerHTML = `<p style="padding:20px; color:red">Eroare: ${error.message}</p>`;
    }
  }

  // Pornim funcția imediat
  incarcaDetalii();
</script>

</body>
</html>